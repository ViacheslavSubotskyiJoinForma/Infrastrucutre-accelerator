locals {
  # Dynamic subnet creation based on availability_zone_count
  # Private subnets: .1.0/24, .2.0/24, .3.0/24
  private_subnets = [
    for i in range(var.availability_zone_count) :
    "${var.cidr[var.env]}.${i + 1}.0/24"
  ]

  # Database subnets: .61.0/24, .62.0/24, .63.0/24
  database_subnets = [
    for i in range(var.availability_zone_count) :
    "${var.cidr[var.env]}.${i + 61}.0/24"
  ]

  # Public subnets: .21.0/24, .22.0/24, .23.0/24
  public_subnets = [
    for i in range(var.availability_zone_count) :
    "${var.cidr[var.env]}.${i + 21}.0/24"
  ]

  cluster_name = "{{ project_name }}_${upper(var.env)}"

  tags = {
    env                      = var.env
    project                  = "{{ project_name }}"
    "karpenter.sh/discovery" = local.cluster_name
  }
}
